<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nerdix Pulse | Deep Focus</title>

<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;500;700&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">

<style>
:root{
--c01:#0c0c0d;--c02:#17181a;--c03:#232426;--c04:#2e3033;
--c05:#3a3c40;--c08:#5d6066;--c10:#747880;
--text:#d1d1d1;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Ubuntu}
body{background:var(--c01);color:var(--text);height:100vh;overflow:hidden}
.app{max-width:420px;margin:auto;padding:70px 16px;display:flex;flex-direction:column;gap:16px}
.card{background:var(--c02);border:1px solid var(--c03);border-radius:20px;padding:20px}
.btn{width:100%;padding:16px;border-radius:16px;border:none;font-weight:700;letter-spacing:2px;background:var(--c10);color:#000;cursor:pointer}
.digit{font-family:"JetBrains Mono";font-size:2.4rem}
.hidden{display:none}
</style>
</head>

<body>

<!-- YOUTUBE PLAYER -->
<div id="yt-player" style="width:0;height:0;opacity:0"></div>

<!-- SFX -->
<audio id="finish-sfx" src="/luar-biasa.mp3" preload="auto"></audio>

<div class="app">
    <div class="card" style="text-align:center">
        <b>Nerdix Pulse</b>
        <p style="opacity:.7;font-size:.8rem;margin-top:6px">Deep focus session</p>
    </div>

    <div class="card" style="text-align:center">
        <div class="digit" id="time">00:00:10</div>
        <button class="btn" id="startBtn">MULAI SESI</button>
        <button class="btn hidden" id="stopBtn" style="margin-top:8px;background:none;border:1px solid var(--c04);color:var(--text)">HENTIKAN</button>
    </div>

    <div class="card hidden" id="finishBox" style="text-align:center">
        <div style="font-size:2.5rem">üèÜ</div>
        <b>LUAR BIASA!</b>
        <p style="margin:10px 0;opacity:.8">Fokus kamu solid hari ini.</p>
        <button class="btn" onclick="resetAll()">RESTART</button>
    </div>
</div>

<script>
let total = 10;
let timer;
let player;
let unlocked = false;

const startBtn = document.getElementById("startBtn");
const stopBtn = document.getElementById("stopBtn");
const timeEl = document.getElementById("time");
const finishBox = document.getElementById("finishBox");
const sfx = document.getElementById("finish-sfx");

/* ===== AUDIO UNLOCK (WAJIB DI VERCEL) ===== */
function unlockAudio(){
    if(unlocked) return;
    unlocked = true;

    sfx.volume = 0;
    sfx.play().then(()=>sfx.pause()).catch(()=>{});

    if(player){
        player.mute();
        player.playVideo();
        setTimeout(()=>{
            player.pauseVideo();
            player.unMute();
        },200);
    }
}

/* ===== TIMER ===== */
function startTimer(){
    unlockAudio();

    startBtn.classList.add("hidden");
    stopBtn.classList.remove("hidden");

    timer = setInterval(()=>{
        total--;
        timeEl.textContent = `00:00:${String(total).padStart(2,"0")}`;
        if(total<=0) finish();
    },1000);

    if(player) player.playVideo();
}

function stopTimer(){
    clearInterval(timer);
    if(player) player.pauseVideo();
    resetUI();
}

function finish(){
    clearInterval(timer);
    if(player) player.pauseVideo();

    sfx.currentTime = 0;
    sfx.volume = 1;
    sfx.play().catch(()=>{});

    finishBox.classList.remove("hidden");
    stopBtn.classList.add("hidden");
}

function resetUI(){
    startBtn.classList.remove("hidden");
    stopBtn.classList.add("hidden");
}

function resetAll(){
    total = 10;
    timeEl.textContent = "00:00:10";
    finishBox.classList.add("hidden");
    resetUI();
}

/* ===== EVENTS ===== */
startBtn.onclick = startTimer;
stopBtn.onclick = stopTimer;

/* ===== YOUTUBE ===== */
var tag=document.createElement("script");
tag.src="https://www.youtube.com/iframe_api";
document.body.appendChild(tag);

function onYouTubeIframeAPIReady(){
    player=new YT.Player("yt-player",{
        videoId:"8xGUbBNtPKg",
        playerVars:{
            autoplay:0,
            controls:0,
            loop:1,
            playlist:"8xGUbBNtPKg"
        }
    });
}
</script>

</body>
</html>
